(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32003,e=>{"use strict";var t=e.i(95187),a=(0,t.createServerReference)("40dbeeb162e059ce773ea6d9a6027e012cc9ed5594",t.callServer,void 0,t.findSourceMapURL,"getData");e.s(["getData",()=>a])},95187,(e,t,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={callServer:function(){return l.callServer},createServerReference:function(){return o.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var s in r)Object.defineProperty(a,s,{enumerable:!0,get:r[s]});let l=e.r(32120),i=e.r(92245),o=e.r(35326)},75157,e=>{"use strict";function t(e){return/^[0-9]+$/.test(e.toString())}function a(e){return/^[a-zA-Z0-9!@#$%^&*()_\-+=\[\]{}|\\:;"'<>,.?/]+$/.test(e)}function r(e){return null===e?"â€”":"boolean"==typeof e?e?"SÃ­":"No":"object"==typeof e?JSON.stringify(e):String(e)}e.s(["formatDate",0,e=>e?new Date(e).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"-","formatValue",()=>r,"getLastDocument",0,e=>Array.isArray(e)&&0!==e.length?e.reduce((e,t)=>t.version>e.version?t:e):null,"validatePassword",()=>a,"validateUser",()=>t])},74793,48686,62259,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(69620);function s({open:e,onClose:s,schema:l,initialData:i,onSubmit:o}){let[c,n]=(0,a.useState)({}),d=!!i;(0,a.useEffect)(()=>{if(d)n(i);else{let e={};l.fields.forEach(t=>e[t.name]=""),n(e)}},[i,l.fields,d]);let u=(e,t)=>{n({...c,[e]:t})},m=async e=>{e.preventDefault(),await o(c,d),s()};return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 relative shadow-xl",children:[(0,t.jsx)("button",{onClick:s,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:(0,t.jsx)(r.IoClose,{size:22})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-6",children:d?l.titleEdit:l.titleCreate}),(0,t.jsxs)("form",{className:"space-y-4 max-h-[65vh] overflow-y-auto pr-2",onSubmit:m,children:[l.fields.map(e=>(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-gray-600",children:e.label}),"select"===e.type?(0,t.jsxs)("select",{value:c[e.name]??"",disabled:d&&e.disabledOnEdit,onChange:t=>u(e.name,t.target.value),className:"w-full mt-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-(--primary-color)",children:[(0,t.jsx)("option",{value:"",children:"Seleccione"}),e.options?.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}):"file"===e.type?(0,t.jsxs)("div",{className:"mt-1",children:[(0,t.jsx)("input",{type:"file",multiple:!0,onChange:t=>{let a=t.target.files?Array.from(t.target.files):[];u(e.name,a)},className:"w-full text-sm text-gray-500 border rounded-lg p-2   file:mr-4 file:py-1 file:px-3 file:rounded-md   file:border-0 file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),Array.isArray(c[e.name])&&c[e.name].length>0&&(0,t.jsx)("ul",{className:"mt-2 space-y-1",children:c[e.name].map((e,a)=>(0,t.jsxs)("li",{className:"text-xs text-blue-600 flex items-center gap-1",children:[(0,t.jsxs)("span",{className:"truncate max-w-[200px]",children:["ðŸ“„ ",e.name]}),(0,t.jsxs)("span",{className:"text-gray-400",children:["(",(e.size/1024).toFixed(1)," KB)"]})]},a))})]}):(0,t.jsx)("input",{type:e.type,value:c[e.name]??"",disabled:d&&e.disabledOnEdit,onChange:t=>u(e.name,t.target.value),className:"w-full mt-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-(--primary-color)"})]},e.name)),(0,t.jsx)("button",{className:"w-full mt-4 bg-(--primary-color) text-white py-2 rounded-lg font-medium hover:opacity-90",children:d?l.submitEditLabel:l.submitCreateLabel})]})]})}):null}e.s(["GenericCrudModal",()=>s],74793);var l=e.i(95187),i=(0,l.createServerReference)("40df1140757c877a0cf5908cbf3501a791abd968f4",l.callServer,void 0,l.findSourceMapURL,"insertDataStudent"),o=(0,l.createServerReference)("4023375bd8a23baae2dbdd008432443971914172c5",l.callServer,void 0,l.findSourceMapURL,"updateDataProfessor"),c=(0,l.createServerReference)("603f537fdc2a97a1500ac983e263e983cb53542d1f",l.callServer,void 0,l.findSourceMapURL,"insertData"),n=(0,l.createServerReference)("789356f77ab1b0865bf38f9fb0beb43681a836e7c7",l.callServer,void 0,l.findSourceMapURL,"updateData"),d=e.i(32003),u=(0,l.createServerReference)("402620dffcd3c85786e3b09cbf5845ddde39a9ce98",l.callServer,void 0,l.findSourceMapURL,"createProject"),m=(0,l.createServerReference)("40125bccffa017b42e903c0dcaad09bf605e682708",l.callServer,void 0,l.findSourceMapURL,"updatePhaseProject"),p=(0,l.createServerReference)("404c6d4fcb17c8ca1923809c46ed86bb2511a6522c",l.callServer,void 0,l.findSourceMapURL,"updatePhaseProjectDate"),b=(0,l.createServerReference)("60095e3d4e4173083ded4e8a12e6c7ddd48913e0d1",l.callServer,void 0,l.findSourceMapURL,"updateProject"),f=(0,l.createServerReference)("40bc103f492b054c2a0e26064e9bcd8274593ac6c1",l.callServer,void 0,l.findSourceMapURL,"updateUserStatus"),x=(0,l.createServerReference)("7899d074825ab2fdb144caec3875c5e99aea2a7fa3",l.callServer,void 0,l.findSourceMapURL,"getCustomData");e.s(["getCustomData",()=>x],48686),e.s(["tableConfig",0,{users:{schema:{titleCreate:"Crear usuario",titleEdit:"Editar usuario",submitCreateLabel:"Crear usuario",submitEditLabel:"Actualizar usuario",fields:[{name:"name",label:"Nombre *",type:"text"},{name:"id_document",label:"Documento *",type:"text"},{name:"id_role",label:"Rol *",type:"select"},{name:"email",label:"Email *",type:"email"},{name:"password",label:"ContraseÃ±a *",type:"password"},{name:"program",label:"Programa *",type:"select"},{name:"id_status",label:"Estado *",type:"select"},{name:"id_school",label:"Escuela *",type:"select"}]},createAction:async(e,t)=>{c(e,t)},updateAction:async(e,t,a)=>{n(e,t,a,"id_user")},loadRelations:async()=>({roles:await (0,d.getData)("roles"),programs:await (0,d.getData)("programs"),status:await (0,d.getData)("status_user"),schools:await (0,d.getData)("schools")})},schools:{schema:{titleCreate:"Crear escuela",titleEdit:"Editar escuela",submitCreateLabel:"Crear",submitEditLabel:"Actualizar",fields:[{name:"name",label:"Nombre *",type:"text"}]},createAction:async(e,t)=>{c(e,t)},updateAction:async(e,t,a)=>{n(e,t,a,"id_school")}},programs:{schema:{titleCreate:"Crear programa",titleEdit:"Editar programa",submitCreateLabel:"Crear",submitEditLabel:"Actualizar",fields:[{name:"name",label:"Nombre *",type:"text"},{name:"id_school",label:"Escuela *",type:"select"}]},createAction:async(e,t)=>{c(e,t)},updateAction:async(e,t,a)=>{n(e,t,a,"id_program")},loadRelations:async()=>({schools:await (0,d.getData)("schools")})},Project:{schema:{titleCreate:"Crear proyecto",titleEdit:"Editar proyecto",submitCreateLabel:"Crear proyecto",submitEditLabel:"Actualizar proyecto",fields:[{name:"title",label:"Nombre *",type:"text"},{name:"description",label:"DescripciÃ³n *",type:"text"},{name:"is_best",label:"Gran proyecto",type:"text"},{name:"id_program",label:"Programa *",type:"select"},{name:"id_school",label:"Escuela *",type:"select"},{name:"id_mode",label:"tipo de proyecto *",type:"select"},{name:"initial_date",label:"Fecha inicial *",type:"date"},{name:"id_professors *",label:"Profesores",type:"multiselect"},{name:"id_students *",label:"Estudiantes",type:"multiselect"}]},createAction:async e=>{u(e)},updateAction:async(e,t)=>{b(e,t)},loadRelations:async e=>({schools:await x("schools","*",e),programs:await x("programs","id_program, name",e),mode:await x("modes"),students:await x("users","id_user, name",e,4),professors:await x("users","id_user, name",e,3)})},usersManager:{schema:{titleCreate:"Actualizar estatus del usuario",titleEdit:"Actualizar estado del estudiante",submitCreateLabel:"Crear",submitEditLabel:"Actualizar",fields:[{name:"id_status",label:"Estatus",type:"select"}]},updateAction:async e=>{f(e)},loadRelations:async()=>({status:await x("status_user")})},newPhase:{schema:{titleCreate:"Actualizar fase del proyecto",titleEdit:"Actualizar fase del proyecto",submitCreateLabel:"Actualizar proyecto",submitEditLabel:"Actualizar proyecto",fields:[{name:"id_work *",label:"titulo del proyecto",type:"select"},{name:"id_phase *",label:"Fase",type:"select"},{name:"initial_date *",label:"Fecha inicial",type:"date"},{name:"id_professors *",label:"Profesores",type:"multiselect"},{name:"id_students *",label:"Estudiantes",type:"multiselect"}]},createAction:async e=>{m(e)},loadRelations:async e=>({phase:await x("phase"),works:await x("works","id_work, title",e),students:await x("users","id_user, name",e,4),professors:await x("users","id_user, name",e,3)})},datePhase:{schema:{titleCreate:"Actualizar fecha fin",titleEdit:"Actualizar fecha fin",submitCreateLabel:"Actualizar fecha",submitEditLabel:"Actualizar",fields:[{name:"id_work *",label:"titulo del proyecto",type:"select"},{name:"id_phase *",label:"Fase del proyecto",type:"select"},{name:"end_date *",label:"Fin de la fase",type:"date"}]},createAction:async e=>{p(e)},loadRelations:async e=>({phase:await x("phase"),works:await x("works","id_work, title",e)})},studentAdvance:{schema:{titleCreate:"Nuevo avance",titleEdit:"Editar avance",submitCreateLabel:"Subir avance",submitEditLabel:"Actualizar",fields:[{name:"file",label:"Archivo word o excel *",type:"file"},{name:"version",label:"version *",type:"text"},{name:"description",label:"DescripciÃ³n",type:"text"}]},createAction:async e=>{await i(e)}},professorFeedback:{schema:{titleCreate:"Nuevo avance",titleEdit:"Editar avance",submitCreateLabel:"Subir avance",submitEditLabel:"Actualizar",fields:[{name:"file",label:"Archivo word o excel *",type:"file"},{name:"professor_comments",label:"Comentarios del profesor",type:"text"}]},updateAction:async e=>{await o(e)}}}],62259)},58994,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(71315),s=e.i(69620),l=e.i(78631),i=e.i(74793),o=e.i(62259),c=e.i(75157),n=e.i(95187),d=(0,n.createServerReference)("7067efb95fb57b3e3a2940159955556052fe646855",n.callServer,void 0,n.findSourceMapURL,"getData"),u=(0,n.createServerReference)("401d31679b75714ae4424928917c2ac71275ce4008",n.callServer,void 0,n.findSourceMapURL,"getStudentsDetails"),m=e.i(82043);function p(){let{user:e}=(0,m.useAuth)(),[r,l]=(0,a.useState)([]),[c,n]=(0,a.useState)(!1),[p,f]=(0,a.useState)(""),[x,y]=(0,a.useState)(!1),[h,v]=(0,a.useState)(null),[g,w]=(0,a.useState)(null);async function _(){if(e?.id_user){n(!0);try{let t=await d("works","id_work, title, description, id_students, modes(name), work_documents(id_work_documents, version, description, upload_date, document_paths, professor_comments, document_professor_paths)",e.id_user),a=[...new Set(t.flatMap(e=>e.id_students))];if(a.length>0){let e=await u(a),r=t.map(t=>({...t,work_documents:Array.isArray(t.work_documents)?t.work_documents.sort((e,t)=>new Date(t.upload_date).getTime()-new Date(e.upload_date).getTime()):[],students:e.filter(e=>t.id_students.includes(e.id_user))}));l(r)}else l(t)}catch(e){l([])}n(!1)}}(0,a.useEffect)(()=>{_(),S()},[e]);let j=r.filter(e=>e.title?.toLowerCase().includes(p.toLowerCase())||e.description?.toLowerCase().includes(p.toLowerCase()));async function S(){let t=o.tableConfig.professorFeedback;t&&e?.id_user&&w(structuredClone(t.schema))}let N=async e=>{let t=o.tableConfig.professorFeedback;try{let a=new FormData,r=h.work_documents?.[0];if(r&&a.append("id_work_documents",String(r.id_work_documents)),a.append("professor_comments",e.professor_comments||""),e.file){let t=e.file instanceof File?e.file:e.file[0];a.append("files",t)}await t.updateAction(a),y(!1),await _()}catch(e){console.error("Error al procesar")}};return(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-7 gap-4",children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"Dashboard Profesor"}),(0,t.jsxs)("div",{className:"relative w-full md:w-80",children:[(0,t.jsx)(s.IoSearchOutline,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,t.jsx)("input",{type:"text",placeholder:"Buscar proyecto...",value:p,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-xl text-sm"})]})]}),(0,t.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border p-4 md:p-6",children:(0,t.jsx)("div",{className:"flex flex-col gap-6",children:(0,t.jsx)("div",{className:"relative h-[60vh] md:h-[65vh]",children:c?(0,t.jsxs)("div",{className:"flex items-center justify-center h-full text-gray-500",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),"Cargando datos del proyecto"]}):(0,t.jsx)(b,{data:j,onAction:e=>{v(e),y(!0)}})})})}),g&&x&&(0,t.jsx)(i.GenericCrudModal,{open:x,onClose:()=>y(!1),schema:g,onSubmit:N})]})}function b({data:e,onAction:a}){if(!e||0===e.length)return(0,t.jsx)("div",{className:"py-20 text-center text-gray-400 font-medium",children:"No se encontraron registros."});let i=async(e,t)=>{let a=new r.default,s=a.folder(`archivos-profesor-v${t}`),i=e.map(async(e,t)=>{let a=await fetch(e),r=await a.blob(),l=e.split("/").pop()?.split("?")[0]||`archivo-${t}`;s?.file(l,r)});await Promise.all(i);let o=await a.generateAsync({type:"blob"});(0,l.saveAs)(o,`revision-profesor-v${t}.zip`)};return(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full text-left border-separate border-spacing-0",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-50",children:[(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Proyecto"}),(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Estudiantes"}),(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Emails"}),(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Modo"}),(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Fecha subida"}),(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Archivos"}),(0,t.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b text-right",children:"AcciÃ³n"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-100",children:e.map((e,r)=>{let l=(0,c.getLastDocument)(e.work_documents),o=!!l,n=!!l&&(l.professor_comments&&""!==l.professor_comments.trim()||Array.isArray(l.document_professor_paths)&&l.document_professor_paths.length>0);return(0,t.jsxs)("tr",{className:`transition-colors ${n?"bg-green-50":"bg-red-50"}`,children:[(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium",children:e.title}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:e.students?.map(e=>e.name).join(", ")||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.students?.map(e=>e.email).join(", ")||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:e.modes?.name||"-"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,c.formatDate)(l?.upload_date)}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:o?(0,t.jsxs)("button",{onClick:()=>i(l.document_paths,l.version),className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 text-green-700 border border-green-200 rounded-lg text-xs",children:[(0,t.jsx)(s.IoDownloadOutline,{size:16}),"Descargar ZIP"]}):(0,t.jsx)("span",{className:"text-gray-400 italic",children:"Sin archivos"})}),(0,t.jsx)("td",{className:"px-6 py-4 text-right",children:(0,t.jsxs)("button",{onClick:()=>a(e),className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xs font-medium",children:[(0,t.jsx)(s.IoChatbubbleEllipsesOutline,{size:16}),"Feedback"]})})]},r)})})]})})}e.s(["default",()=>p],58994)}]);