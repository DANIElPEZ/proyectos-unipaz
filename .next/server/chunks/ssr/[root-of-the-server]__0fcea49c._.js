module.exports=[24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},55673,a=>{"use strict";var b=a.i(5050),c=(0,b.createServerReference)("40dbeeb162e059ce773ea6d9a6027e012cc9ed5594",b.callServer,void 0,b.findSourceMapURL,"getData");a.s(["getData",()=>c])},5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},68114,a=>{"use strict";function b(a){return/^[0-9]+$/.test(a.toString())}function c(a){return/^[a-zA-Z0-9!@#$%^&*()_\-+=\[\]{}|\\:;"'<>,.?/]+$/.test(a)}function d(a){return null===a?"â€”":"boolean"==typeof a?a?"SÃ­":"No":"object"==typeof a?JSON.stringify(a):String(a)}a.s(["formatDate",0,a=>a?new Date(a).toLocaleDateString("es-CO",{year:"numeric",month:"short",day:"numeric"}):"-","formatValue",()=>d,"getLastDocument",0,a=>Array.isArray(a)&&0!==a.length?a.reduce((a,b)=>b.version>a.version?b:a):null,"validatePassword",()=>c,"validateUser",()=>b])},47165,95063,16807,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(48617);function e({open:a,onClose:e,schema:f,initialData:g,onSubmit:h}){let[i,j]=(0,c.useState)({}),k=!!g;(0,c.useEffect)(()=>{if(k)j(g);else{let a={};f.fields.forEach(b=>a[b.name]=""),j(a)}},[g,f.fields,k]);let l=(a,b)=>{j({...i,[a]:b})},m=async a=>{a.preventDefault(),await h(i,k),e()};return a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"bg-white rounded-2xl w-full max-w-md p-6 relative shadow-xl",children:[(0,b.jsx)("button",{onClick:e,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700",children:(0,b.jsx)(d.IoClose,{size:22})}),(0,b.jsx)("h3",{className:"text-xl font-semibold text-gray-800 mb-6",children:k?f.titleEdit:f.titleCreate}),(0,b.jsxs)("form",{className:"space-y-4 max-h-[65vh] overflow-y-auto pr-2",onSubmit:m,children:[f.fields.map(a=>(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm text-gray-600",children:a.label}),"select"===a.type?(0,b.jsxs)("select",{value:i[a.name]??"",disabled:k&&a.disabledOnEdit,onChange:b=>l(a.name,b.target.value),className:"w-full mt-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-(--primary-color)",children:[(0,b.jsx)("option",{value:"",children:"Seleccione"}),a.options?.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}):"file"===a.type?(0,b.jsxs)("div",{className:"mt-1",children:[(0,b.jsx)("input",{type:"file",multiple:!0,onChange:b=>{let c=b.target.files?Array.from(b.target.files):[];l(a.name,c)},className:"w-full text-sm text-gray-500 border rounded-lg p-2   file:mr-4 file:py-1 file:px-3 file:rounded-md   file:border-0 file:text-sm file:font-semibold   file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),Array.isArray(i[a.name])&&i[a.name].length>0&&(0,b.jsx)("ul",{className:"mt-2 space-y-1",children:i[a.name].map((a,c)=>(0,b.jsxs)("li",{className:"text-xs text-blue-600 flex items-center gap-1",children:[(0,b.jsxs)("span",{className:"truncate max-w-[200px]",children:["ðŸ“„ ",a.name]}),(0,b.jsxs)("span",{className:"text-gray-400",children:["(",(a.size/1024).toFixed(1)," KB)"]})]},c))})]}):(0,b.jsx)("input",{type:a.type,value:i[a.name]??"",disabled:k&&a.disabledOnEdit,onChange:b=>l(a.name,b.target.value),className:"w-full mt-1 px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-(--primary-color)"})]},a.name)),(0,b.jsx)("button",{className:"w-full mt-4 bg-(--primary-color) text-white py-2 rounded-lg font-medium hover:opacity-90",children:k?f.submitEditLabel:f.submitCreateLabel})]})]})}):null}a.s(["GenericCrudModal",()=>e],47165);var f=a.i(5050),g=(0,f.createServerReference)("40df1140757c877a0cf5908cbf3501a791abd968f4",f.callServer,void 0,f.findSourceMapURL,"insertDataStudent"),h=(0,f.createServerReference)("4023375bd8a23baae2dbdd008432443971914172c5",f.callServer,void 0,f.findSourceMapURL,"updateDataProfessor"),i=(0,f.createServerReference)("603f537fdc2a97a1500ac983e263e983cb53542d1f",f.callServer,void 0,f.findSourceMapURL,"insertData"),j=(0,f.createServerReference)("789356f77ab1b0865bf38f9fb0beb43681a836e7c7",f.callServer,void 0,f.findSourceMapURL,"updateData"),k=a.i(55673),l=(0,f.createServerReference)("402620dffcd3c85786e3b09cbf5845ddde39a9ce98",f.callServer,void 0,f.findSourceMapURL,"createProject"),m=(0,f.createServerReference)("40125bccffa017b42e903c0dcaad09bf605e682708",f.callServer,void 0,f.findSourceMapURL,"updatePhaseProject"),n=(0,f.createServerReference)("404c6d4fcb17c8ca1923809c46ed86bb2511a6522c",f.callServer,void 0,f.findSourceMapURL,"updatePhaseProjectDate"),o=(0,f.createServerReference)("60095e3d4e4173083ded4e8a12e6c7ddd48913e0d1",f.callServer,void 0,f.findSourceMapURL,"updateProject"),p=(0,f.createServerReference)("40bc103f492b054c2a0e26064e9bcd8274593ac6c1",f.callServer,void 0,f.findSourceMapURL,"updateUserStatus"),q=(0,f.createServerReference)("7899d074825ab2fdb144caec3875c5e99aea2a7fa3",f.callServer,void 0,f.findSourceMapURL,"getCustomData");a.s(["getCustomData",()=>q],95063),a.s(["tableConfig",0,{users:{schema:{titleCreate:"Crear usuario",titleEdit:"Editar usuario",submitCreateLabel:"Crear usuario",submitEditLabel:"Actualizar usuario",fields:[{name:"name",label:"Nombre *",type:"text"},{name:"id_document",label:"Documento *",type:"text"},{name:"id_role",label:"Rol *",type:"select"},{name:"email",label:"Email *",type:"email"},{name:"password",label:"ContraseÃ±a *",type:"password"},{name:"program",label:"Programa *",type:"select"},{name:"id_status",label:"Estado *",type:"select"},{name:"id_school",label:"Escuela *",type:"select"}]},createAction:async(a,b)=>{i(a,b)},updateAction:async(a,b,c)=>{j(a,b,c,"id_user")},loadRelations:async()=>({roles:await (0,k.getData)("roles"),programs:await (0,k.getData)("programs"),status:await (0,k.getData)("status_user"),schools:await (0,k.getData)("schools")})},schools:{schema:{titleCreate:"Crear escuela",titleEdit:"Editar escuela",submitCreateLabel:"Crear",submitEditLabel:"Actualizar",fields:[{name:"name",label:"Nombre *",type:"text"}]},createAction:async(a,b)=>{i(a,b)},updateAction:async(a,b,c)=>{j(a,b,c,"id_school")}},programs:{schema:{titleCreate:"Crear programa",titleEdit:"Editar programa",submitCreateLabel:"Crear",submitEditLabel:"Actualizar",fields:[{name:"name",label:"Nombre *",type:"text"},{name:"id_school",label:"Escuela *",type:"select"}]},createAction:async(a,b)=>{i(a,b)},updateAction:async(a,b,c)=>{j(a,b,c,"id_program")},loadRelations:async()=>({schools:await (0,k.getData)("schools")})},Project:{schema:{titleCreate:"Crear proyecto",titleEdit:"Editar proyecto",submitCreateLabel:"Crear proyecto",submitEditLabel:"Actualizar proyecto",fields:[{name:"title",label:"Nombre *",type:"text"},{name:"description",label:"DescripciÃ³n *",type:"text"},{name:"is_best",label:"Gran proyecto",type:"text"},{name:"id_program",label:"Programa *",type:"select"},{name:"id_school",label:"Escuela *",type:"select"},{name:"id_mode",label:"tipo de proyecto *",type:"select"},{name:"initial_date",label:"Fecha inicial *",type:"date"},{name:"id_professors *",label:"Profesores",type:"multiselect"},{name:"id_students *",label:"Estudiantes",type:"multiselect"}]},createAction:async a=>{l(a)},updateAction:async(a,b)=>{o(a,b)},loadRelations:async a=>({schools:await q("schools","*",a),programs:await q("programs","id_program, name",a),mode:await q("modes"),students:await q("users","id_user, name",a,4),professors:await q("users","id_user, name",a,3)})},usersManager:{schema:{titleCreate:"Actualizar estatus del usuario",titleEdit:"Actualizar estado del estudiante",submitCreateLabel:"Crear",submitEditLabel:"Actualizar",fields:[{name:"id_status",label:"Estatus",type:"select"}]},updateAction:async a=>{p(a)},loadRelations:async()=>({status:await q("status_user")})},newPhase:{schema:{titleCreate:"Actualizar fase del proyecto",titleEdit:"Actualizar fase del proyecto",submitCreateLabel:"Actualizar proyecto",submitEditLabel:"Actualizar proyecto",fields:[{name:"id_work *",label:"titulo del proyecto",type:"select"},{name:"id_phase *",label:"Fase",type:"select"},{name:"initial_date *",label:"Fecha inicial",type:"date"},{name:"id_professors *",label:"Profesores",type:"multiselect"},{name:"id_students *",label:"Estudiantes",type:"multiselect"}]},createAction:async a=>{m(a)},loadRelations:async a=>({phase:await q("phase"),works:await q("works","id_work, title",a),students:await q("users","id_user, name",a,4),professors:await q("users","id_user, name",a,3)})},datePhase:{schema:{titleCreate:"Actualizar fecha fin",titleEdit:"Actualizar fecha fin",submitCreateLabel:"Actualizar fecha",submitEditLabel:"Actualizar",fields:[{name:"id_work *",label:"titulo del proyecto",type:"select"},{name:"id_phase *",label:"Fase del proyecto",type:"select"},{name:"end_date *",label:"Fin de la fase",type:"date"}]},createAction:async a=>{n(a)},loadRelations:async a=>({phase:await q("phase"),works:await q("works","id_work, title",a)})},studentAdvance:{schema:{titleCreate:"Nuevo avance",titleEdit:"Editar avance",submitCreateLabel:"Subir avance",submitEditLabel:"Actualizar",fields:[{name:"file",label:"Archivo word o excel *",type:"file"},{name:"version",label:"version *",type:"text"},{name:"description",label:"DescripciÃ³n",type:"text"}]},createAction:async a=>{await g(a)}},professorFeedback:{schema:{titleCreate:"Nuevo avance",titleEdit:"Editar avance",submitCreateLabel:"Subir avance",submitEditLabel:"Actualizar",fields:[{name:"file",label:"Archivo word o excel *",type:"file"},{name:"professor_comments",label:"Comentarios del profesor",type:"text"}]},updateAction:async a=>{await h(a)}}}],16807)},72417,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(7739),e=a.i(48617),f=a.i(70179),g=a.i(47165),h=a.i(16807),i=a.i(68114),j=a.i(5050),k=(0,j.createServerReference)("7067efb95fb57b3e3a2940159955556052fe646855",j.callServer,void 0,j.findSourceMapURL,"getData"),l=(0,j.createServerReference)("401d31679b75714ae4424928917c2ac71275ce4008",j.callServer,void 0,j.findSourceMapURL,"getStudentsDetails"),m=a.i(56432);function n(){let{user:a}=(0,m.useAuth)(),[d,f]=(0,c.useState)([]),[i,j]=(0,c.useState)(!1),[n,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null);async function w(){if(a?.id_user){j(!0);try{let b=await k("works","id_work, title, description, id_students, modes(name), work_documents(id_work_documents, version, description, upload_date, document_paths, professor_comments, document_professor_paths)",a.id_user),c=[...new Set(b.flatMap(a=>a.id_students))];if(c.length>0){let a=await l(c),d=b.map(b=>({...b,work_documents:Array.isArray(b.work_documents)?b.work_documents.sort((a,b)=>new Date(b.upload_date).getTime()-new Date(a.upload_date).getTime()):[],students:a.filter(a=>b.id_students.includes(a.id_user))}));f(d)}else f(b)}catch(a){f([])}j(!1)}}(0,c.useEffect)(()=>{w(),y()},[a]);let x=d.filter(a=>a.title?.toLowerCase().includes(n.toLowerCase())||a.description?.toLowerCase().includes(n.toLowerCase()));async function y(){let b=h.tableConfig.professorFeedback;b&&a?.id_user&&v(structuredClone(b.schema))}let z=async a=>{let b=h.tableConfig.professorFeedback;try{let c=new FormData,d=s.work_documents?.[0];if(d&&c.append("id_work_documents",String(d.id_work_documents)),c.append("professor_comments",a.professor_comments||""),a.file){let b=a.file instanceof File?a.file:a.file[0];c.append("files",b)}await b.updateAction(c),r(!1),await w()}catch(a){console.error("Error al procesar")}};return(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-7 gap-4",children:[(0,b.jsx)("h2",{className:"text-3xl font-bold text-gray-800",children:"Dashboard Profesor"}),(0,b.jsxs)("div",{className:"relative w-full md:w-80",children:[(0,b.jsx)(e.IoSearchOutline,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Buscar proyecto...",value:n,onChange:a=>p(a.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-xl text-sm"})]})]}),(0,b.jsx)("div",{className:"bg-white rounded-2xl shadow-sm border p-4 md:p-6",children:(0,b.jsx)("div",{className:"flex flex-col gap-6",children:(0,b.jsx)("div",{className:"relative h-[60vh] md:h-[65vh]",children:i?(0,b.jsxs)("div",{className:"flex items-center justify-center h-full text-gray-500",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-3"}),"Cargando datos del proyecto"]}):(0,b.jsx)(o,{data:x,onAction:a=>{t(a),r(!0)}})})})}),u&&q&&(0,b.jsx)(g.GenericCrudModal,{open:q,onClose:()=>r(!1),schema:u,onSubmit:z})]})}function o({data:a,onAction:c}){if(!a||0===a.length)return(0,b.jsx)("div",{className:"py-20 text-center text-gray-400 font-medium",children:"No se encontraron registros."});let g=async(a,b)=>{let c=new d.default,e=c.folder(`archivos-profesor-v${b}`),g=a.map(async(a,b)=>{let c=await fetch(a),d=await c.blob(),f=a.split("/").pop()?.split("?")[0]||`archivo-${b}`;e?.file(f,d)});await Promise.all(g);let h=await c.generateAsync({type:"blob"});(0,f.saveAs)(h,`revision-profesor-v${b}.zip`)};return(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full text-left border-separate border-spacing-0",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"bg-gray-50",children:[(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Proyecto"}),(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Estudiantes"}),(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Emails"}),(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Modo"}),(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Fecha subida"}),(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b",children:"Archivos"}),(0,b.jsx)("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 border-b text-right",children:"AcciÃ³n"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-100",children:a.map((a,d)=>{let f=(0,i.getLastDocument)(a.work_documents),h=!!f,j=!!f&&(f.professor_comments&&""!==f.professor_comments.trim()||Array.isArray(f.document_professor_paths)&&f.document_professor_paths.length>0);return(0,b.jsxs)("tr",{className:`transition-colors ${j?"bg-green-50":"bg-red-50"}`,children:[(0,b.jsx)("td",{className:"px-6 py-4 text-sm font-medium",children:a.title}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:a.students?.map(a=>a.name).join(", ")||"-"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-600",children:a.students?.map(a=>a.email).join(", ")||"-"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:a.modes?.name||"-"}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,i.formatDate)(f?.upload_date)}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm",children:h?(0,b.jsxs)("button",{onClick:()=>g(f.document_paths,f.version),className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 text-green-700 border border-green-200 rounded-lg text-xs",children:[(0,b.jsx)(e.IoDownloadOutline,{size:16}),"Descargar ZIP"]}):(0,b.jsx)("span",{className:"text-gray-400 italic",children:"Sin archivos"})}),(0,b.jsx)("td",{className:"px-6 py-4 text-right",children:(0,b.jsxs)("button",{onClick:()=>c(a),className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xs font-medium",children:[(0,b.jsx)(e.IoChatbubbleEllipsesOutline,{size:16}),"Feedback"]})})]},d)})})]})})}a.s(["default",()=>n],72417)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0fcea49c._.js.map